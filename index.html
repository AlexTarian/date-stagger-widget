<!doctype html>
<html>
  <head>
    <script src="//js.jotform.com/JotFormCustomWidget.min.js"></script>
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
  </head>
  <style></style>
  <body>
    <div id="reviewArea">
      <div>Version 6 </div>
      <div>Start Date: </div>
      <div>End Date: </div>
      <div>Workers: </div>
    </div>
    <script type="text/javascript">
      function tableExampleForCleaningDepot() {
        const start = JFCustomWidget.getWidgetSetting('startFieldId');
        const end = JFCustomWidget.getWidgetSetting('endFieldId');
        const workers = JFCustomWidget.getWidgetSetting('totalWorkersFieldId');

        console.log(`start param: ${start}`)
        console.log(`end param: ${end}`)
        console.log(`workers param: ${workers}`)

        // exposed functions
        this.init = init;
        this.getData = getData;
        const otherFields = [
          'startDate',
          'endDate',
          'h2aWorkers'
        ]

        function getFieldsByX(){
          console.log("Running getFieldsByX")
          JFCustomWidget.getFieldsValueByName(otherFields, function(res){
              setTimeout(console.log(`Here's the data ${JSON.stringify(res, null, 2)}`), 500)
          })
        }

        function getStartDate(){
          console.log("Running getStartDate")
          JFCustomWidget.getFieldsValueById(start, function(res){
              console.log(`start date is ${res}`)
          })
        }
        function getEndDate(){
          console.log("Running getEndDate")
          JFCustomWidget.getFieldsValueById(end, function(res){
              console.log(`end date is ${res}`)
          })
        }
        function getWorkers(){
          console.log("Running getWorkers")
          JFCustomWidget.getFieldsValueById(workers, function(res){
              console.log(`worker count is ${res}`)
          })
        }

        // initialization of the widget
        function init(formData) {
          console.log("Hello world!");
          getFieldsByX()
          getStartDate()
          getEndDate()
          getWorkers()
        }

        // get widget data
        function getData() {
          return {
            valid: true,
            value: "TEST"
          };
        }
      }

      // always subscribe to ready event and implement widget related code
      // inside callback function , it is the best practice while developing widgets
      JFCustomWidget.subscribe("ready", function (data) {
        var widget = new tableExampleForCleaningDepot();
        widget.init(data);

        JFCustomWidget.subscribe("submit", function () {
          JFCustomWidget.sendSubmit(widget.getData());
        });
      });
    </script>
  </body>
</html>








